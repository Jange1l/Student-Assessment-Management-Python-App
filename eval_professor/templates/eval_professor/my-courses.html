{% extends 'eval_professor/base-sidebar.html'%}

{% load static %}

{% block title %} My Courses {% endblock %}

{% block content%}
	<!-- Other page content to the right of the NAV BAR -->
	<div id="main">

		<!-- ********************** current courses ********************** -->
		<div class="container">
			<h2 style="color: #6C63FF;">Current Courses</h2>
		</div>

		<div class="container">
			{% if course_list %}
				<!-- <div class="row"></div> -->
					{% for course in course_list|dictsort:"course_code" %}	
						{% if request.user in course.professors.all %}
						{% if course.is_active %}
							<div class="column course-box">	
										<h3> {{ course.course_name }}</h3>
										{% for prof in course.professors.all|dictsort:"first_name" %}
										<h4> Professor {{ prof.first_name }} {{ prof.last_name }}</h4>
										{% endfor %}
										<h4> <b>Code:</b> {{ course.course_code }}</h4>
										<h4> <b>Section:</b> {{ course.section_number }}</h4>
										<h4> <b>Time:</b> {{ course.year }}{{ course.semester }}</h4>
										<h4> <b>Number of students:</b> {{ course.students.all|length }} </h4>
										
										<div style="margin-top: 2%; margin-bottom: 2%;" id="accordion">
											<div class="card">
											  <div class="card-header" id="headingOne">
												<h5 class="mb-0">
												  <button style="color: #6C63FF;" class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
													Show all students
												  </button>
												</h5>
											  </div>
										  
											  <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
												<div class="card-body">
													{% if course.students.all|length == 0 %}
														<p>No students in the course.</p>
													{% else %}
														{% for student in course.students.all|dictsort:"last_name" %}

															<div class="student-info"> {{ student.last_name }}, {{ student.first_name }} - {{ student.email }}</div>

														{% endfor %}
													{% endif %}
												</div>
											  </div>
											</div>
											<div class="card">
											  <div class="card-header" id="headingTwo">
												<h5 class="mb-0">
												  <button style="color: #6C63FF;" class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
													Add student to course
												  </button>
												</h5>
											  </div>
											  <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
												<div class="card-body">
												  Enter email <b>OR</b> Eagle ID (only choose 1) of the student. Note that a student must be registered by the admin to have a valid email or Eagle ID.
												  <!-- Form to take inputs -->
												  <form action="{% url 'add_student' course_id=course.id %}" method="post">
														<div class="container">
																<div class="row align-items-end">
																	<div class="form-group col-5 col-md-5 ">
																		<label for="">Email or Eagle ID</label>
																		{% csrf_token %}
																		<input name='id or email' required=True  class="form-control" type="text">
																	</div>
										
																	<div class="form-group col-6 col-md-2">
																		<button type="submit" class="btn btn-primary buttons purple">Add</button>
																	</div>
																</div>
														</div>
												  </form>
												  <!-- Form Ends -->
												  

												</div>
											  </div>
											</div>
											
										  </div>


										<a class="buttons purple delete-btn" href="{% url 'delete_course' course_id=course.id %}">Delete Course</a>
							
							</div>
						{% endif %}
						{% endif %}
					{% endfor %}
				<!-- </div>		 -->
			{% else %}
				<p>No current courses are available. </p>
			{% endif %}
		</div>

		<!-- ********************** past courses ********************** -->
		<div class="container">
			<h2 style="color: rgb(255, 99, 117); margin-top: 5%;">Past Courses</h2>
		</div>

		<div class="container">
			{% if course_list %}
				<!-- <div class="row"></div> -->
					{% for course in course_list|dictsort:"course_code" %}	
						{% if request.user in course.professors.all %}
						{% if not course.is_active %}
							<div class="column course-box">	
										<h3> {{ course.course_name }}</h3>
										{% for prof in course.professors.all|dictsort:"first_name" %}
										<h4> Professor {{ prof.first_name }} {{ prof.last_name }}</h4>
										{% endfor %}
										<h4> <b>Code:</b> {{ course.course_code }}</h4>
										<h4> <b>Section:</b> {{ course.section_number }}</h4>
										<h4> <b>Time:</b> {{ course.year }}{{ course.semester }}</h4>
										<a class="buttons purple delete-btn" href="{% url 'delete_course' course_id=course.id %}">Delete Course</a>
							</div>
						{% endif %}
						{% endif %}
					{% endfor %}
				<!-- </div>		 -->
			{% else %}
				<p>No past courses are available. </p>
			{% endif %}
		</div>
		
		
		
	</div>
{% endblock %}